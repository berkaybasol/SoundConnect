server:
  port: 8080
  address: 0.0.0.0  #//telefon erisimi ciin

spring:
  datasource:
    url: ${SOUNDCONNECT_POSTGRE_URL}
    username: ${SOUNDCONNECT_POSTGRE_USERNAME}
    password: ${SOUNDCONNECT_POSTGRE_PASSWORD}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.PostgreSQLDialect
        type:
          descriptor:
            sql: trace

  rabbitmq:
    host: localhost
    port: 5672
    username: guest
    password: guest
    virtual-host: /
    publisher-confirm-type: correlated
    publisher-returns: true

  security:
    oauth2:
      client:
        registration:
          google:
            client-id: ${GOOGLE_CLIENT_ID}
            client-secret: ${GOOGLE_CLIENT_SECRET}
            redirect-uri: "{baseUrl}/api/auth/google/callback"
            scope: [openid, email, profile]
        provider:
          google:
            authorization-uri: https://accounts.google.com/o/oauth2/v2/auth
            token-uri: https://oauth2.googleapis.com/token          # ← indent düzeltildi
            user-info-uri: https://openidconnect.googleapis.com/v1/userinfo   # ← indent düzeltildi
            user-name-attribute: email                                        # ← indent düzeltildi
  data:
    redis:
      host: localhost
      port: 6379
      # password: koymadik
    rest:
      default-media-type:
  hateoas:
    use-hal-as-default-json-media-type:

springdoc:
  swagger-ui:
    path: /swagger-ui.html

app:
  jwt:
    secret: ${SOUNDCONNECT_JWT_SECRETKEY}
    expiration: ${SOUNDCONNECT_JWT_EXTIME}
    issuer: ${SOUNDCONNECT_JWT_ISSUER}
  data:
    init:
      enabled: true         # ← RUNTIME’DA AÇIK
  location:
    seed:
      enabled: true         # ← Ankara vb. başlangıç verisi gerekiyorsa AÇIK

otp:
  ttl:
    minutes: 3              # OtpService @Value("${otp.ttl.minutes:...}") ile okur
  length: 6                 # 6 haneli
  max-attempt: 5            # yanlis deneme limiti
  resend:
    cooldown:
      seconds: 30

mailersend:
  api-key: ${MAILERSEND_API_KEY}
  from-email: ${MAILERSEND_SENDER_EMAIL}
  from-name: SoundConnect
  otp-validity-minutes: 3  # mail icerigindeki "kod suresi" — otp.ttl ile SENKRON

logging:
  level:
    root: INFO
    org.springframework.web: DEBUG
    org.hibernate.SQL: DEBUG

# --- MEDIA / STORAGE ---
cloud:
  storage:
    provider: s3
    bucket: soundconnect-media
    region: eu-central-1
    accessKey: ${S3_ACCESS_KEY}
    secretKey: ${S3_SECRET_KEY}
    cdnBaseUrl: https://du3pguch18ell.cloudfront.net
    endpoint: ""
    pathStyleAccess: false
    presign:
      expirySeconds: 900
    aclPublicReadOnPut: false

media:
  limits:
    imageMaxBytes: 20000000
    audioMaxBytes: 200000000         # 200mb (
    videoMaxBytes: 4000000000        # 4GB
  allowedMime:
    image: [image/png, image/jpeg, image/webp]
    audio: [audio/mpeg, audio/aac, audio/wav, audio/x-wav, audio/ogg]
    video: [video/mp4, video/quicktime, video/x-matroska]

  paths:
    root: media
    hlsDir: hls
    sourceBasename: source

rabbitmq:
  media:
    exchange: media.transcode
    dlx: media.transcode.dlx
    queues:
      videoHls: media.transcode.video.hls
      videoHlsDlq: media.transcode.video.hls.dlq
    routingKeys:
      videoHlsRequest: video.hls.request
      videoHlsRequestDlq: video.hls.request.dlq
    listenerConcurrency: 1-3   # -> eklendi

transcode:
  ladder:
    - { height: 1080, videoBitrate: "6000k", audioBitrate: "192k" }
    - { height: 720,  videoBitrate: "3000k", audioBitrate: "160k" }
    - { height: 480,  videoBitrate: "1200k", audioBitrate: "128k" }
    - { height: 360,  videoBitrate: "600k",  audioBitrate: "96k"  }
  gop: 48
  preset: veryfast
  crf: 21
  container: FMP4
  segmentDurationSec: 4    # -> eklendi
  ffprobeBinary: ffprobe   # -> eklendi
  ffprobeTimeoutSec: 30    # -> eklendi